 /******************************************************************************
 *
 * Header file for FIR filtering 
 * 
 ******************************************************************************/
#include "stm32f10x.h"

//////////////////////////////////////////////////////////////
//  Filter Code Definitions
//////////////////////////////////////////////////////////////

// maximum number of inputs that can be handled
// in one function call
#define MAX_INPUT_LEN   20
// maximum length of filter than can be handled
#define MAX_FLT_LEN     1115
// buffer to hold all of the input samples
#define BUFFER_LEN      (MAX_FLT_LEN - 1 + MAX_INPUT_LEN)

// array to hold input samples
uint16_t insamp[ BUFFER_LEN ];

void firFixedInit( void );
void firFixed( uint16_t *coeffs, uint16_t *input, uint16_t *output, int length, int filterLength );

uint16_t coeffs[1115] = {
      263,      0,      0,     37,     56,     22,      0,      0,      0,
        0,      8,     26,     30,     19,      0,      0,      0,      0,
        0,     10,     22,     23,     14,      0,      0,      0,      0,
        0,      7,     18,     22,     15,      3,      0,      0,      0,
        0,      2,     14,     20,     17,      7,      0,      0,      0,
        0,      0,     10,     18,     19,     12,      0,      0,      0,
        0,      0,      4,     14,     18,     15,      5,      0,      0,
        0,      0,      0,      9,     16,     17,     10,      0,      0,
        0,      0,      0,      3,     11,     16,     13,      5,      0,
        0,      0,      0,      0,      6,     12,     13,      8,      0,
        0,      0,      0,      0,      1,      7,     10,      9,      4,
        0,      0,      0,      0,      0,      3,      7,      7,      4,
        0,      0,      0,      0,      0,      1,      3,      3,      2,
        0,      0,      0,      0,      0,      1,      1,      0,      0,
        0,      0,      0,      2,      4,      5,      2,      0,      0,
        0,      0,      0,      3,      8,     10,      7,      1,      0,
        0,      0,      0,      1,      9,     14,     13,      7,      0,
        0,      0,      0,      0,      7,     16,     20,     15,      3,
        0,      0,      0,      0,      0,     14,     23,     23,     13,
        0,      0,      0,      0,      0,      7,     22,     28,     23,
        7,      0,      0,      0,      0,      0,     16,     29,     30,
       19,      0,      0,      0,      0,      0,      5,     24,     33,
       29,     12,      0,      0,      0,      0,      0,     14,     30,
       33,     23,      4,      0,      0,      0,      0,      1,     21,
       32,     30,     15,      0,      0,      0,      0,      0,      9,
       24,     30,     22,      6,      0,      0,      0,      0,      0,
       14,     24,     23,     14,      0,      0,      0,      0,      0,
        3,     14,     18,     15,      6,      0,      0,      0,      0,
        0,      5,     10,     10,      6,      0,      0,      0,      0,
        0,      0,      1,      1,      0,      0,      0,      3,      5,
        5,      3,      0,      0,      0,      0,      0,      6,     14,
       17,     12,      2,      0,      0,      0,      0,      1,     17,
       27,     26,     14,      0,      0,      0,      0,      0,     11,
       32,     40,     32,      9,      0,      0,      0,      0,      0,
       27,     48,     50,     30,      0,      0,      0,      0,      0,
       11,     45,     62,     53,     21,      0,      0,      0,      0,
        0,     30,     63,     70,     48,      5,      0,      0,      0,
        0,      5,     50,     75,     70,     35,      0,      0,      0,
        0,      0,     26,     67,     80,     61,     16,      0,      0,
        0,      0,      0,     45,     77,     76,     44,      0,      0,
        0,      0,      0,     16,     59,     77,     63,     24,      0,
        0,      0,      0,      0,     32,     63,     67,     44,      3,
        0,      0,      0,      0,      5,     39,     56,     49,     23,
        0,      0,      0,      0,      0,     15,     34,     39,     27,
        6,      0,      0,      0,      0,      0,     12,     18,     15,
        7,      0,      0,      0,      0,      0,      0,      0,      0,
        0,      0,      6,     17,     23,     19,      5,      0,      0,
        0,      0,      0,     29,     51,     53,     32,      0,      0,
        0,      0,      0,     18,     66,     89,     76,     28,      0,
        0,      0,      0,      0,     57,    113,    125,     84,      4,
        0,      0,      0,      0,     16,    110,    163,    149,     71,
        0,      0,      0,      0,      0,     71,    172,    205,    153,
       34,      0,      0,      0,      0,      0,    141,    233,    231,
      131,      0,      0,      0,      0,      0,     66,    218,    283,
      232,     81,      0,      0,      0,      0,      0,    152,    291,
      312,    202,      6,      0,      0,      0,      0,     40,    243,
      349,    311,    142,      0,      0,      0,      0,      0,    140,
      327,    380,    276,     55,      0,      0,      0,      0,      0,
      242,    391,    378,    208,      0,      0,      0,      0,      0,
      106,    334,    425,    340,    114,      0,      0,      0,      0,
        0,    217,    404,    424,    269,      2,      0,      0,      0,
        0,     57,    314,    441,    386,    171,      0,      0,  32322,
        0,      0,    171,    386,    441,    314,     57,      0,      0,
        0,      0,      2,    269,    424,    404,    217,      0,      0,
        0,      0,      0,    114,    340,    425,    334,    106,      0,
        0,      0,      0,      0,    208,    378,    391,    242,      0,
        0,      0,      0,      0,     55,    276,    380,    327,    140,
        0,      0,      0,      0,      0,    142,    311,    349,    243,
       40,      0,      0,      0,      0,      6,    202,    312,    291,
      152,      0,      0,      0,      0,      0,     81,    232,    283,
      218,     66,      0,      0,      0,      0,      0,    131,    231,
      233,    141,      0,      0,      0,      0,      0,     34,    153,
      205,    172,     71,      0,      0,      0,      0,      0,     71,
      149,    163,    110,     16,      0,      0,      0,      0,      4,
       84,    125,    113,     57,      0,      0,      0,      0,      0,
       28,     76,     89,     66,     18,      0,      0,      0,      0,
        0,     32,     53,     51,     29,      0,      0,      0,      0,
        0,      5,     19,     23,     17,      6,      0,      0,      0,
        0,      0,      0,      0,      0,      0,      0,      7,     15,
       18,     12,      0,      0,      0,      0,      0,      6,     27,
       39,     34,     15,      0,      0,      0,      0,      0,     23,
       49,     56,     39,      5,      0,      0,      0,      0,      3,
       44,     67,     63,     32,      0,      0,      0,      0,      0,
       24,     63,     77,     59,     16,      0,      0,      0,      0,
        0,     44,     76,     77,     45,      0,      0,      0,      0,
        0,     16,     61,     80,     67,     26,      0,      0,      0,
        0,      0,     35,     70,     75,     50,      5,      0,      0,
        0,      0,      5,     48,     70,     63,     30,      0,      0,
        0,      0,      0,     21,     53,     62,     45,     11,      0,
        0,      0,      0,      0,     30,     50,     48,     27,      0,
        0,      0,      0,      0,      9,     32,     40,     32,     11,
        0,      0,      0,      0,      0,     14,     26,     27,     17,
        1,      0,      0,      0,      0,      2,     12,     17,     14,
        6,      0,      0,      0,      0,      0,      3,      5,      5,
        3,      0,      0,      0,      1,      1,      0,      0,      0,
        0,      0,      0,      6,     10,     10,      5,      0,      0,
        0,      0,      0,      6,     15,     18,     14,      3,      0,
        0,      0,      0,      0,     14,     23,     24,     14,      0,
        0,      0,      0,      0,      6,     22,     30,     24,      9,
        0,      0,      0,      0,      0,     15,     30,     32,     21,
        1,      0,      0,      0,      0,      4,     23,     33,     30,
       14,      0,      0,      0,      0,      0,     12,     29,     33,
       24,      5,      0,      0,      0,      0,      0,     19,     30,
       29,     16,      0,      0,      0,      0,      0,      7,     23,
       28,     22,      7,      0,      0,      0,      0,      0,     13,
       23,     23,     14,      0,      0,      0,      0,      0,      3,
       15,     20,     16,      7,      0,      0,      0,      0,      0,
        7,     13,     14,      9,      1,      0,      0,      0,      0,
        1,      7,     10,      8,      3,      0,      0,      0,      0,
        0,      2,      5,      4,      2,      0,      0,      0,      0,
        0,      1,      1,      0,      0,      0,      0,      0,      2,
        3,      3,      1,      0,      0,      0,      0,      0,      4,
        7,      7,      3,      0,      0,      0,      0,      0,      4,
        9,     10,      7,      1,      0,      0,      0,      0,      0,
        8,     13,     12,      6,      0,      0,      0,      0,      0,
        5,     13,     16,     11,      3,      0,      0,      0,      0,
        0,     10,     17,     16,      9,      0,      0,      0,      0,
        0,      5,     15,     18,     14,      4,      0,      0,      0,
        0,      0,     12,     19,     18,     10,      0,      0,      0,
        0,      0,      7,     17,     20,     14,      2,      0,      0,
        0,      0,      3,     15,     22,     18,      7,      0,      0,
        0,      0,      0,     14,     23,     22,     10,      0,      0,
        0,      0,      0,     19,     30,     26,      8,      0,      0,
        0,      0,     22,     56,     37,      0,      0,    263
};
